import{r as l,p as F,u as G,A as P,j as e,B as T,a as d,S as m}from"./index-Bu8AOAn8.js";function O(){var b;const[g,p]=l.useState(""),[x,u]=l.useState(""),[v,k]=l.useState(""),[o,h]=l.useState({}),[f,n]=l.useState(!1),S=((b=F().state)==null?void 0:b.from)||"/";let i=G();function C(){i("/signup"),window.scrollTo({top:0,behavior:"instant"})}function w(s){const{name:t,value:r}=s.target;t==="email"&&p(r),t==="password"&&u(r),t==="checkbox"&&k(v?"":"checkbox checked")}async function L(){n(!0);try{let s=await d.post("https://backoffice.innerpece.com/api/v1/login",{email:g,password:x});const t=s.data.token,r=s.data.user_details;localStorage.setItem("loginid",t),localStorage.setItem("loginDetails",JSON.stringify(r)),p(""),u(""),h(""),m.fire({position:"center",icon:"success",title:"Login successfully",showConfirmButton:!1,timer:1500}),setTimeout(()=>{i(S),window.scrollTo({top:0,behavior:"smooth"})},2e3),n(!1)}catch(s){console.log(s),n(!1);let t=s.response.data.errors?s.response.data.errors:s.response.data;h({...t}),console.log(t)}}const[j,I]=l.useState(null),E=s=>{I(s)};l.useState(null);const B=P({onSuccess:async s=>{try{const t=await d.get("https://www.googleapis.com/oauth2/v3/userinfo",{headers:{Authorization:`Bearer ${s.access_token}`}});A({...t.data})}catch(t){console.error("Failed to fetch user info",t)}},onError:()=>console.log("Login Failed")}),A=async s=>{var t,r,y,N;try{let a=await d.post("https://backoffice.innerpece.com/api/v1/auth/google/callback",{...s});m.fire({position:"center",icon:"success",title:"Login Success",showConfirmButton:!1,timer:2e3});let D=a.data.token,c=a.data.user_details;c={...c,googlePicture:s.picture},localStorage.setItem("loginid",D),localStorage.setItem("loginDetails",JSON.stringify(c)),setTimeout(()=>{i("/")},2e3)}catch(a){console.log(a),console.log((r=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:r.error),m.fire({position:"center",icon:"error",title:"Login Failed",text:((N=(y=a.response)==null?void 0:y.data)==null?void 0:N.error)||"Something went wrong!",showConfirmButton:!1,timer:2500})}};return e.jsx("div",{className:"flex items-center justify-center mt-8 md:mt-14",children:e.jsx("div",{className:"w-full sm:w-[80vw] md:w-[70vw] lg:w-[60vw]  shadow-2xl  shadow-black/30 rounded-md",children:e.jsxs("div",{className:"flex justify-start gap-2 md:gap-5 lg:gap-8 h-full w-full px-2 md:px-4 py-4",children:[e.jsx("div",{className:' bg-[url("././assets/login_image.png")] max-sm:hidden  w-1/5  md:w-1/3 flex-shrink bg-cover  bg-center bg-no-repeat'}),e.jsx("div",{className:"w-2/5 flex-grow flex-shrink",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("p",{className:"text-xl md:text-2xl lg:text-3xl font-semibold",children:"Log In To Get Started"}),e.jsx("div",{className:"flex flex-col flex-wrap lg:flex-row justify-between gap-5 mt-5",children:e.jsxs("div",{className:"flex flex-col flex-grow gap-2",children:[e.jsx("label",{htmlFor:"email",className:"font-semibold",children:"Email"}),e.jsx("input",{type:"text",name:"email",id:"email",value:g,autoComplete:"off",onChange:w,className:"border-2 border-gray-300 outline-none p-2 rounded-md",placeholder:"Enter your Email"}),o.email&&e.jsx("p",{className:"text-red-500 text-xs sm:text-sm ",children:o.email}),o.error==="Unauthorized User "&&e.jsx("p",{className:"text-red-500 text-xs sm:text-sm ",children:o.error})]})}),e.jsxs("div",{className:"flex flex-col mt-5 gap-2",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("label",{htmlFor:"password",className:"font-semibold",children:"Your Password"})}),e.jsx("input",{onFocus:s=>s.target.type="text",onBlur:s=>s.target.type="password",type:"password",id:"password",name:"password",value:x,onChange:w,autoComplete:"off",placeholder:"Enter your Password",className:"border-2  border-gray-300 outline-none p-2 rounded-md"}),o.password&&e.jsx("p",{className:"text-red-500 text-xs sm:text-sm ",children:o.password}),o.error==="Incorrect password"&&e.jsx("p",{className:"text-red-500 text-xs sm:text-sm ",children:o.error})]}),e.jsx("div",{className:"recaptacha-login  mt-5",children:e.jsx(T,{sitekey:"6LfDSrsqAAAAAI2jP2tOdr2l4VkiztyX2S2H0Fxg",onChange:E})}),e.jsx("button",{disabled:!j||f,onClick:L,className:`${j?"bg-sky-800":"bg-gray-400"} transition-all duration-300 w-full p-3 mt-2 rounded-md text-white`,children:f?e.jsx("div",{className:"flex justify-center items-center",children:e.jsx("span",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"})}):"Log In"}),e.jsxs("button",{onClick:()=>B(),className:"flex items-center justify-center gap-3 px-6 py-3 bg-white shadow-md rounded-lg border hover:bg-gray-50 transition",children:[e.jsx("img",{src:"https://developers.google.com/identity/images/g-logo.png",alt:"Google Logo",className:"w-5 h-5"}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Continue with Google"})]}),e.jsxs("div",{className:"flex items-center flex-wrap mt-5 mb-5 gap-2 ",children:[e.jsx("p",{children:"Don't you have an account?"}),e.jsx("button",{onClick:C,className:"bg-sky-800 px-3 py-1 cursor-pointer  text-white rounded",children:"Register"})]})]})})]})})})}export{O as default};
